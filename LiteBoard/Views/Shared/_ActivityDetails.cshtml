@using Humanizer;
@using Microsoft.AspNetCore.Identity;
@model LiteBoard.Models.Project
@inject UserManager<Member> userManager;




<!-- Latest Updates start -->
<div class="p-xl-0">	
	<div class="rounded-3 ">
		<!-- Dashboard menu -->
		<div class="list-group list-group-dark list-group-borderless">
			<a class="list-group-item active">Project Activity</a>
			@foreach (var activity in Model.Activities.OrderByDescending(activity => activity.UpdatedDate).Take(9))
			{
				var member = userManager.Users.Where(m => m.Id == activity.MemberId).FirstOrDefault();


				if (activity.Description == "completed_task")
				{
					double timestamp = activity.CreatedDate.ToOADate();
					var timeSpan = DateTime.FromOADate(timestamp).AddMicroseconds(-timestamp).Humanize();
					<a class="list-group-item" href="~/projects/details/@Model.Id"><span class="fw-bold">@member.FirstName</span> completed <span class="text-warning">@activity.Subject</span><span class="text-secondary small"> @timeSpan</span></a>
				}
				if (activity.Description == "updated_task")
				{
					double timestamp = activity.CreatedDate.ToOADate();
					var timeSpan = DateTime.FromOADate(timestamp).AddMicroseconds(-timestamp).Humanize();
					<a class="list-group-item" href="~/projects/details/@Model.Id"><span class="fw-bold">@member.FirstName</span> updated <span class="text-warning">@activity.Subject</span><span class="text-secondary small"> @timeSpan</span></a>
				}
				if (activity.Description == "created_task")
				{
					double timestamp = activity.CreatedDate.ToOADate();
					var timeSpan = DateTime.FromOADate(timestamp).AddMicroseconds(-timestamp).Humanize();
					<a class="list-group-item" href="~/projects/details/@Model.Id"><span class="fw-bold">@member.FirstName</span> created <span class="text-warning">@activity.Subject</span><span class="text-secondary small"> @timeSpan</span></a>
				}
				if (activity.Description == "created_project")
				{
					double timestamp = activity.CreatedDate.ToOADate();
					var timeSpan = DateTime.FromOADate(timestamp).AddMicroseconds(-timestamp).Humanize();
					<a class="list-group-item" href="~/projects/details/@Model.Id"><span class="fw-bold">@Model.Member.FirstName</span> created <span class="text-warning">@activity.Subject</span><span class="text-secondary small"> @timeSpan</span></a>
				}
				if (activity.Description == "updated_title")
				{
					double timestamp = activity.UpdatedDate.ToOADate();
					var timeSpan = DateTime.FromOADate(timestamp).AddMicroseconds(-timestamp).Humanize();
					<a class="list-group-item" href="~/projects/details/@Model.Id"><span class="fw-bold">@Model.Member.FirstName</span> Changed the Project Title  <span class="text-warning">@Html.Raw(activity.Subject)</span><span class="text-secondary small"> @timeSpan</span></a>
				}
				if (activity.Description == "updated_notes")
				{
					double timestamp = activity.UpdatedDate.ToOADate();
					var timeSpan = DateTime.FromOADate(timestamp).AddMicroseconds(-timestamp).Humanize();
					<a class="list-group-item" href="~/projects/details/@Model.Id"><span class="fw-bold">@member.FirstName</span> updated the <span class="text-warning">Project Notes</span><span class="text-secondary small"> @timeSpan</span></a>
				}
				if (activity.Description == "added_member")
				{
					double timestamp = activity.UpdatedDate.ToOADate();
					var timeSpan = DateTime.FromOADate(timestamp).AddMicroseconds(-timestamp).Humanize();
					<a class="list-group-item" href="~/projects/details/@Model.Id"><span class="fw-bold">@Model.Member.FirstName</span> added a new member to <span class="text-warning">@activity.Subject</span><span class="text-secondary small"> @timeSpan</span></a>
				}





			}
		</div>
	</div>
</div>
<!-- Latest Updates End -->